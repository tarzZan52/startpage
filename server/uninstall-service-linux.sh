#!/bin/bash

# ะกะบัะธะฟั ัะดะฐะปะตะฝะธั Dashboard ัะตัะฒะธัะฐ

# ะฆะฒะตัะฐ ะดะปั ะฒัะฒะพะดะฐ
GREEN='\033[0;32m'
RED='\033[0;31m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
CYAN='\033[0;36m'
NC='\033[0m'

clear
echo -e "${CYAN}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
echo -e "${CYAN}     ะฃะะะะะะะ DASHBOARD ะะะขะะะะะฃะกะะ${NC}"
echo -e "${CYAN}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
echo ""

# ะัะพะฒะตััะตะผ ะฟัะฐะฒะฐ sudo
echo -e "${BLUE}๐ ะัะพะฒะตัะบะฐ ะฟัะฐะฒ ะฐะดะผะธะฝะธัััะฐัะพัะฐ...${NC}"
if ! sudo -n true 2>/dev/null; then
    echo -e "${YELLOW}ะะปั ัะดะฐะปะตะฝะธั ัะธััะตะผะฝะพะณะพ ัะตัะฒะธัะฐ ััะตะฑััััั ะฟัะฐะฒะฐ ะฐะดะผะธะฝะธัััะฐัะพัะฐ${NC}"
    echo "ะะพะถะฐะปัะนััะฐ, ะฒะฒะตะดะธัะต ะฟะฐัะพะปั ะดะปั ะฟัะพะดะพะปะถะตะฝะธั..."
    if ! sudo true; then
        echo -e "${RED}โ ะัะบะฐะทะฐะฝะพ ะฒ ะดะพัััะฟะต. ะฃะดะฐะปะตะฝะธะต ะฟัะตัะฒะฐะฝะพ.${NC}"
        exit 1
    fi
fi

# ะััะฐะฝะฐะฒะปะธะฒะฐะตะผ ัะตัะฒะธั
echo -e "${BLUE}๐ ะััะฐะฝะพะฒะบะฐ ัะตัะฒะธัะฐ...${NC}"
if sudo systemctl stop dashboard.service 2>/dev/null; then
    echo -e "${GREEN}โ ะกะตัะฒะธั ะพััะฐะฝะพะฒะปะตะฝ${NC}"
else
    echo -e "${YELLOW}โ๏ธ  ะกะตัะฒะธั ัะถะต ะฑัะป ะพััะฐะฝะพะฒะปะตะฝ ะธะปะธ ะฝะต ัััะตััะฒัะตั${NC}"
fi

# ะัะบะปััะฐะตะผ ะฐะฒัะพะทะฐะฟััะบ
echo -e "${BLUE}๐ ะัะบะปััะตะฝะธะต ะฐะฒัะพะทะฐะฟััะบะฐ...${NC}"
if sudo systemctl disable dashboard.service 2>/dev/null; then
    echo -e "${GREEN}โ ะะฒัะพะทะฐะฟััะบ ะพัะบะปััะตะฝ${NC}"
else
    echo -e "${YELLOW}โ๏ธ  ะะฒัะพะทะฐะฟััะบ ัะถะต ะฑัะป ะพัะบะปััะตะฝ${NC}"
fi

# ะฃะดะฐะปัะตะผ ัะฐะนะป ัะตัะฒะธัะฐ
echo -e "${BLUE}๐๏ธ  ะฃะดะฐะปะตะฝะธะต ัะฐะนะปะฐ ัะตัะฒะธัะฐ...${NC}"
if [[ -f /etc/systemd/system/dashboard.service ]]; then
    if sudo rm -f /etc/systemd/system/dashboard.service; then
        echo -e "${GREEN}โ ะคะฐะนะป ัะตัะฒะธัะฐ ัะดะฐะปะตะฝ${NC}"
    else
        echo -e "${RED}โ ะัะธะฑะบะฐ ัะดะฐะปะตะฝะธั ัะฐะนะปะฐ ัะตัะฒะธัะฐ${NC}"
    fi
else
    echo -e "${YELLOW}โ๏ธ  ะคะฐะนะป ัะตัะฒะธัะฐ ะฝะต ะฝะฐะนะดะตะฝ${NC}"
fi

# ะะตัะตะทะฐะณััะถะฐะตะผ systemd
echo -e "${BLUE}๐ ะะตัะตะทะฐะณััะทะบะฐ systemd...${NC}"
if sudo systemctl daemon-reload; then
    echo -e "${GREEN}โ Systemd ะฟะตัะตะทะฐะณััะถะตะฝ${NC}"
else
    echo -e "${RED}โ ะัะธะฑะบะฐ ะฟะตัะตะทะฐะณััะทะบะธ systemd${NC}"
fi

# ะะฐะฒะตััะฐะตะผ ะฟัะพัะตััั Python (ะตัะปะธ ะทะฐะฟััะตะฝั)
echo -e "${BLUE}๐ ะััะฐะฝะพะฒะบะฐ Python ัะตัะฒะตัะพะฒ...${NC}"
pkill -f "python.*http.server.*8000" 2>/dev/null
pkill -f "python3.*http.server.*8000" 2>/dev/null

echo ""
echo -e "${GREEN}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
echo -e "${GREEN}     โ ะกะะะะะก ะฃะกะะะจะะ ะฃะะะะะ!${NC}"
echo -e "${GREEN}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
echo ""
echo -e "${YELLOW}๐ Dashboard ะฑะพะปััะต ะฝะต ะฑัะดะตั ะทะฐะฟััะบะฐัััั ะฐะฒัะพะผะฐัะธัะตัะบะธ.${NC}"
echo ""
echo -e "${CYAN}๐ ะะปั ัััะฝะพะณะพ ะทะฐะฟััะบะฐ:${NC}"
echo -e "   1. ะะตัะตะนะดะธัะต ะฒ ะบะพัะฝะตะฒัั ะฟะฐะฟะบั ะฟัะพะตะบัะฐ"
echo -e "   2. ะัะฟะพะปะฝะธัะต: ${YELLOW}python3 -m http.server 8000${NC}"
echo -e "   3. ะัะบัะพะนัะต ${YELLOW}http://localhost:8000/${NC} ะฒ ะฑัะฐัะทะตัะต"
echo ""
echo -e "${CYAN}๐ก ะะปั ะฟะพะฒัะพัะฝะพะน ัััะฐะฝะพะฒะบะธ ะทะฐะฟัััะธัะต:${NC}"
echo -e "   ${YELLOW}./install-service-linux.sh${NC}"
echo ""